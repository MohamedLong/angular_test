<div class="layout-invoice-page">
    <p-toast></p-toast>
    <p-confirmDialog key="cfmdialog" [style]="{width: '50vw'}" [baseZIndex]="10000"
        rejectButtonStyleClass="p-button-text"></p-confirmDialog>
    <p-toolbar styleClass="mb-2">
        <ng-template pTemplate="left">
        </ng-template>

        <ng-template pTemplate="right">
            <div class="field col">
                <button pButton pRipple type="button" [style]="{'width':'150px'}"
                    label="{{ 'operations.addPayment' | translate }}" icon="pi pi-dollar" *ngIf="(master?.statusId===2)"
                    (click)="addPayment()" class="mb-3 p-button-success"></button>
            </div>
            <div class="field col">
                <p-confirmPopup></p-confirmPopup>
                <p-menu #menu [popup]="true" [model]="menuItems" [style]="{'width':'200px'}"></p-menu>
                <button pButton pRipple [disabled]="(editable)" class="mb-3 p-button-warning" type="button"
                    icon="{{sending? 'pi pi-spin pi-spinner' : 'pi pi-fw pi-cog'}}"
                    label="{{ 'operations.actions' | translate }}" (click)="menu.toggle($event)"></button>
            </div>
            <div class="field col">
                <button pButton pRipple type="button" label="{{ 'operations.print' | translate }}" icon="pi pi-print"
                    (click)="print()" class="mb-3"></button>
            </div>
        </ng-template>
    </p-toolbar>
    <div class="layout-invoice-content">
        <div class="card">
            <div class="grid">
                <div class="col-12" id="invoice" #invoice>
                    <div class="flex justify-content-between align-items-center p-3 border-2">
                        <div class="text-center">
                            <h5 class="mb-1 uppercase">
                                Oman United insurance Co.s.o.g
                            </h5>
                            <h6 class="capitalize my-0">(auto service division)</h6>
                            <p class="mb-0 capitalize font-medium">P.O.Box 235, postal code 100, muscat, sultanate of oman</p>
                            <p class="capitalize font-medium">tel: 24503692, C.R. NO: 1237250</p>
                        </div>
                        <div class="mx-2 text-center">
                            <img width="100" src="assets/layout/images/united-logo.jpg" alt="invoice-logo" />
                        </div>
                        <div dir="rtl"  class="text-center">
                            <h5 class="mb-1">
                                الشركة العمانية المتحدة للتأمين ش.م.ع.ع
                            </h5>
                            <h6 class="my-0">(قسم خدمات السيارات)</h6>
                            <p class="mb-0 font-medium">ص.ب 235, الرمز البريدي 100, مسقط, سلطنة عمان</p>
                            <p class="mb-0 font-medium">هانف: 24503692, فاكس: 24503692, س.ت. رقم: 1237250</p>
                        </div>
                    </div>
                    <h5 class="text-center">Purchase Order</h5>
                    <div class="p-3">
                        <div class="flex mb-3 justify-content-between">
                            <table class="">
                                <tr>
                                    <th class="text-left capitalize font-medium">supplier name: </th>
                                    <td class="uppercase font-bold">{{masterDto.supplierName}}</td>
                                </tr>
                                <tr>
                                    <th class="text-left capitalize font-medium">supplier address: </th>
                                    <td class="uppercase font-medium">{{masterDto.supplierAddress}}</td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <th class="text-left capitalize font-medium">customer Name: </th>
                                    <td class="uppercase font-bold">{{masterDto.customerName}}</td>
                                </tr>
                                <tr>
                                    <th class="text-left capitalize font-medium">customer address: </th>
                                    <td class="uppercase font-medium">{{masterDto.customerAddress}}</td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <th class="text-left capitalize font-medium">make & model: </th>
                                    <td class="uppercase font-medium">{{bidList[0]? bidList[0].requestTitle : '-'}}</td>
                                </tr>
                                <tr>
                                    <th class="text-left capitalize font-medium">vin number</th>
                                    <td class="uppercase font-medium">{{masterDto.chassisNumber}}</td>
                                </tr>
                                <tr>
                                    <th class="text-left capitalize font-medium">job card: </th>
                                    <td class="uppercase font-medium">{{masterDto.jobNumber? masterDto.jobNumber : '-'}}</td>
                                </tr>
                            </table>
                            <table class="">
                                <tr>
                                    <th class="text-left capitalize font-medium">page no: </th>
                                    <td class="uppercase font-medium">1 of 1</td>
                                </tr>
                                <tr>
                                    <th class="text-left capitalize font-medium"><span class="uppercase">lbo</span>
                                        number: </th>
                                    <td class="uppercase font-medium">{{masterDto.id}}</td>
                                </tr>
                                <tr>
                                    <th class="text-left capitalize font-medium"><span class="uppercase">lbo</span>
                                        date: </th>
                                    <td class="uppercase font-medium">{{masterDto.createdAt  | date: 'dd/MM/yyyy'}}</td>
                                </tr>
                                <tr>
                                    <th class="text-left capitalize font-medium">currency </th>
                                    <td class="uppercase font-medium">{{masterDto.currency}}</td>
                                </tr>
                                <tr>
                                    <th class="text-left capitalize font-medium">country: </th>
                                    <td class="uppercase font-medium">{{masterDto.country}}</td>
                                </tr>
                            </table>
                        </div>
                        <p class="uppercase">
                            please supply the following and debit our account for the value
                        </p>
                        <p-table *ngIf="bidList.length > 0" [columns]="dataCols" [value]="bidList"
                            styleClass="p-invoice-datatable-responsive pb-3">
                            <ng-template pTemplate="header" let-columns>
                                <tr>
                                    <th *ngFor="let col of columns">
                                        {{col.header}}
                                    </th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-order let-columns="columns">
                                <tr>
                                    <td>
                                        {{order.bidId}}
                                    </td>
                                    <td>
                                        {{order.partName}}
                                    </td>
                                    <td>
                                        {{order.unit}}
                                    </td>
                                    <td>
                                        {{order.qty}}
                                    </td>
                                    <td>
                                        {{order.originalPrice | number}}
                                    </td>
                                    <td>
                                        {{order.originalPrice * order.qty | number}}
                                    </td>
                                    <td>
                                        {{order.discount? order.discount : 0}}
                                    </td>
                                    <td>
                                        {{order.vat | number}}
                                    </td>
                                    <td>
                                        {{order.taxAmount | number}}
                                    </td>
                                    <td>
                                        {{order.price | number}}
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                        <div class="flex justify-content-between align-items-end mt-3">
                            <!-- <p class="mb-0 capitalize font-medium">
                               {{order.totalAmount | numToWords}}
                            </p> -->
                            <table class="ml-auto">
                                <tr>
                                    <th class="text-left uppercase font-medium">gross total: </th>
                                    <td class="uppercase font-medium">{{masterDto.orderAmount  | number}}</td>
                                </tr>
                                <tr>
                                    <th class="text-left uppercase font-medium">vat amount: </th>
                                    <td class="uppercase font-medium">{{totalVat  | number}}</td>
                                </tr>
                                <tr>
                                    <th class="text-left uppercase font-medium">net total: </th>
                                    <td class="uppercase font-medium">{{masterDto.totalAmount  | number}}</td>
                                </tr>

                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <p-dialog [(visible)]="confirmActionDialog" header="{{ 'operations.confirmAction' | translate}}" [modal]="true"
    [style]="{width:'450px'}">
    <div class="flex align-items-center justify-content-center">
        <i class="pi pi-exclamation-triangle mr-3" style="font-size: 2rem"></i>
        <span><b>{{ 'operations.confirmActionMessage' | translate }}</b></span>
    </div>
    <ng-template pTemplate="footer">
        <button pButton pRipple icon="pi pi-times" class="p-button-text" label="No"
            (click)="confirmActionDialog = false"></button>
        <button pButton pRipple icon="pi pi-check" class="p-button-text" label="Yes"
            (click)="confirm()"></button>
    </ng-template>
    </p-dialog>

</div>
