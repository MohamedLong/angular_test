<div class="wizard-body">
    <div class="wizard-wrapper">
        <div class="wizard-content">
            <div class="wizard-card">
                <div class="wizard-card-header">
                    <div class="grid col py-3">
                        <div class="col-6 tab flex align-items-center justify-content-center car-info-tab"
                            [ngClass]="{'selected-tab': activeTab == 'car-info'}" (click)="clickNext('car-info')">
                            <div class="title">Car Information</div>
                        </div>
                        <div class="col-6 tab flex align-items-center justify-content-center request-tab"
                            [ngClass]="{'selected-tab': activeTab === 'request'}" (click)="clickNext('request')">
                            <div class="title">Create Request</div>
                        </div>
                    </div>
                </div>
                <div class="wizard-card-content car-info" [ngClass]="{'active-content': activeTab === 'car-info'}">
                    <form [formGroup]="carForm" (ngSubmit)="onCarFormSubmit()">
                        <div class="grid">
                            <div class="col-12">
                                <label class="block">Chassis Number</label>
                                <span class="p-input-icon-right width-100 my-2">
                                    <i class="pi pi-spin pi-spinner" *ngIf="isTyping"></i>
                                    <i class="pi pi-check text-green-500 font-bold" *ngIf="found && !isTyping"></i>
                                    <input formControlName="chassisNumber" class="width-100" type="text" pInputText
                                        (keyup)="onChnKeyup()" (keydown)="onChnKeydown()" placeholder="Ex: 291919AD1914"
                                        required autofocus />
                                </span>
                                <div class="flex align-items-center justify-content-between">
                                    <small
                                        *ngIf="!carForm.get('chassisNumber').valid && carForm.get('chassisNumber').dirty && carForm.get('chassisNumber').errors?.['minlength']"
                                        class="p-error">Min Chassis Number is 13.</small>
                                    <small
                                        *ngIf="submitted && !carForm.get('chassisNumber').valid  && carForm.get('chassisNumber').errors?.['required']"
                                        class="p-error">Chassis Number is Required.</small>
                                    <!-- <small class="block" *ngIf="notFound">Car Chassis Number Not Found, Please Fill out
                                        the Form to Create a New One.</small> -->
                                </div>
                            </div>
                            <div class="col-12 md:col-6">
                                <label class="block mb-2">Brand</label>
                                <p-dropdown [options]="brands" formControlName="brandId" placeholder="Select a Brand"
                                    optionLabel="brandName" (onChange)="getBrandCarModels($event.value)"></p-dropdown>
                            </div>
                            <div class="col-12 md:col-6">
                                <label class="block mb-2">Model</label>
                                <p-dropdown [options]="carModels" formControlName="carModelId" placeholder="Select a Model"
                                    optionLabel="name" emptyMessage="Please Select Car Brand First"></p-dropdown>
                            </div>
                            <div class="col-12 md:col-6">
                                <label class="block mb-2">Year</label>
                                <p-dropdown [options]="carModelYears" formControlName="carModelYearId" placeholder="Select a Year"
                                    optionLabel="year"></p-dropdown>
                            </div>
                            <div class="col-12 md:col-6">
                                <label class="block mb-2">Specification</label>
                                <p-dropdown [options]="carModelTypes" formControlName="carModelTypeId"
                                    placeholder="Select a Specification" optionLabel="type"></p-dropdown>
                            </div>
                            <div class="col-12 md:col-6">
                                <label class="block">License Plate Number</label>
                                <input formControlName="plateNumber" class="width-100 my-2" type="text" pInputText
                                    placeholder="EX: YA59811" required />
                                <small
                                    *ngIf="submitted && !carForm.get('plateNumber').valid &&  carForm.get('plateNumber').errors?.['required']"
                                    class="p-error">Plate Number is Required.</small>
                            </div>
                            <!-- {{carForm.get('chn').errors | json}}
                                    (click)="clickNext('request')"-->
                            <div class="col-12 text-center">
                                <button class="width-100 md:w-20rem" pButton pRipple type="submit"
                                    label="NEXT"></button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="wizard-card-content request" [ngClass]="{'active-content': activeTab === 'request'}">
                    <form [formGroup]="claimForm" (ngSubmit)="onClaimFormSubmit()">
                        <div class="grid">
                            <div class="col-12">
                                <p-messages class="car-info" severity="info">
                                    <ng-template pTemplate>
                                        <p>
                                            {{carForm.get('brandId').value.brandName}} {{carForm.get('carModelId').value.name}}
                                            {{carForm.get('carModelYearId').value.year}} {{carForm.get('carModelTypeId').value.type}};
                                            Chassis Number:
                                            {{carForm.get('chassisNumber').value}};
                                            Licence Plate: {{carForm.get('plateNumber').value}}
                                        </p>
                                    </ng-template>
                                </p-messages>
                            </div>
                            <div class="col-12 md:col-6">
                                <label class="block mb-2">Insurance From</label>
                                <p-dropdown [options]="InsuranceType" formControlName="insuranceFrom" placeholder="OD/TP"></p-dropdown>
                            </div>
                            <div class="col-12  md:col-6">
                                <label class="block">Claim Number</label>
                                <span class="p-input-icon-right width-100 my-2">
                                    <i class="pi pi-spin pi-spinner" *ngIf="isTypingClaim"></i>
                                    <!-- <i class="pi pi-check text-green-500 font-bold" *ngIf="found && !isTyping"></i> -->
                                    <input formControlName="claim" class="width-100" type="text" pInputText
                                        (keyup)="onClaimKeyup()" (keydown)="onClaimKeydown()"
                                        placeholder="Enter Calim Number" required />
                                </span>
                            </div>
                            <div class="col-12 md:col-6">
                                <label class="block mb-2">Job Card Number</label>
                                <p-dropdown *ngIf="jobFound.multiple" [options]="job" formControlName="job"
                                    placeholder="Enter Job Card Number" optionValue="" optionLabel=""></p-dropdown>
                                <input *ngIf="!jobFound.multiple" formControlName="job" class="width-100" type="text" pInputText
                                    placeholder="Enter Job Card Number" required />
                            </div>
                            <div class="col-12 md:col-6 flex align-items-center mt-3">
                                <p-fileUpload class="mt-2 width-100" multiple="multiple"
                                    [chooseIcon]="'pi pi-cloud-upload'" mode="basic" customUpload="true" accept="image/*"
                                    chooseLabel="Upload Car Image" (uploadHandler)="onBasicUpload($event)"></p-fileUpload>
                            </div>
                            <div class="col-12">
                                <p-divider align="left">
                                    <b class="bg-bluegray-50">Add More Details</b>
                                </p-divider>
                            </div>

                            <div class="col-12 md:col-6">
                                <label class="block mb-2">Garage Location</label>
                                <p-dropdown [options]="" formControlName="loaction" placeholder="" optionValue=""
                                    optionLabel=""></p-dropdown>
                            </div>
                            <div class="col-12 md:col-6">
                                <label class="block mb-2">Bid Closing Date</label>
                                <p-calendar appendTo="body" formControlName="closingDate" dateFormat="mm-dd-yy"
                                    inputId="dateformat" [showIcon]="true"></p-calendar>
                            </div>
                            <div class="col-12 md:col-6">
                                <label class="block mb-2">Privacy</label>
                                <p-dropdown appendTo="body" formControlName="privacy" [options]="privacy"
                                    optionLabel="cname" optionValue="cname"></p-dropdown>
                            </div>
                            <div class="col-12 md:col-6" *ngIf="claimForm.get('privacy').value == 'private'">
                                <label class="block mb-2">Private Suppliers</label>
                                <p-multiSelect class="block" maxSelectedLabels="2" appendTo="body"
                                    selectedItemsLabel="{0} items selected" [options]="privacy[1].suppliers"
                                    optionLabel="name" optionValue="userId" [(ngModel)]="selectedPrivateSyppliers"
                                    [ngModelOptions]="{standalone: true}" placehodler="Select Private Suppliers"
                                    required></p-multiSelect>
                            </div>
                            <!-- {{carForm.get('chn').errors | json}}
                                    (click)="clickNext('request')"-->
                            <div class="col-12 text-center">
                                <button class="width-100 md:w-20rem" pButton pRipple type="submit"
                                    label="Create Request"></button>
                            </div>
                        </div>
                    </form>
                    <div class="" *ngIf="activeTab == 'requests'">
                        request
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
